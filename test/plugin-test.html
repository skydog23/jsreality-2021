<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSRViewer Plugin System Test</title>
    <link rel="icon" type="image/png" href="fav_icon.png">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #1e1e1e;
            color: #cccccc;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .header {
            background: #2d2d2d;
            padding: 16px;
            border-bottom: 1px solid #3e3e3e;
        }

        .header h1 {
            margin: 0 0 8px 0;
            font-size: 24px;
            color: #ffffff;
        }

        .header p {
            margin: 0;
            color: #858585;
            font-size: 14px;
        }

        .viewer-container {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #252526;
            padding: 0;
            overflow: hidden;
            min-height: 0;
            position: relative;
        }

        #viewer-canvas {
            border: 2px solid #3e3e3e;
            border-radius: 4px;
            background: white;
            width: 100%;
            height: 100%;
            display: block;
        }

        .info {
            background: #2d2d2d;
            padding: 12px 16px;
            border-top: 1px solid #3e3e3e;
            font-size: 12px;
            color: #858585;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ðŸ”Œ JSRViewer Plugin System Test</h1>
        <p>Demonstrates the plugin architecture with BackgroundColorPlugin</p>
    </div>

    <div class="viewer-container" id="viewer-container">
        <canvas id="viewer-canvas"></canvas>
    </div>

    <div class="info" id="info">
        Initializing...
    </div>

    <script type="module">
        import { TestJSRApp } from '../src/app/examples/TestJSRApp.js';
        import { BackgroundColorPlugin } from '../src/app/plugins/BackgroundColorPlugin.js';

        const canvas = document.getElementById('viewer-canvas');
        const info = document.getElementById('info');

        try {
            info.textContent = 'Creating JSRApp...';
            
            // Create app instance
            const app = new TestJSRApp(canvas);
            
            info.textContent = 'Registering BackgroundColorPlugin...';
            
            // Register background color plugin
            await app.getViewer().registerPlugin(new BackgroundColorPlugin());
            
            info.textContent = 'Calling display()...';
            
            // Call display() method to render
            app.display();
            
            info.textContent = 'âœ“ Plugin system initialized! Check "View" menu for background color options.';
            
            // Expose app globally for debugging
            window.testApp = app;
            console.log('TestJSRApp instance available as window.testApp');
            console.log('Viewer:', app.getViewer());
            console.log('Registered plugins:', app.getViewer().getAllPluginInfo());
            
        } catch (error) {
            console.error('Error creating TestJSRApp:', error);
            info.textContent = 'âœ— Error: ' + error.message;
            info.style.color = '#ff6b6b';
        }
    </script>
</body>
</html>

